class Accordion{constructor(e,t){this._el="string"==typeof e?document.querySelector(e):e;this._config=Object.assign({alwaysOpen:!0,duration:350,itemClass:"accordion__item",headerClass:"accordion__header",bodyClass:"accordion__body"},t),this.addEventListener()}addEventListener(){this._el.addEventListener("click",e=>{const t=e.target.closest("."+this._config.headerClass);if(t){if(!this._config.alwaysOpen){const e=this._el.querySelector(".show");e&&e!==t.parentElement&&this.toggle(e)}this.toggle(t.parentElement)}})}show(e){const t=e.querySelector("."+this._config.bodyClass);if(t.classList.contains("collapsing")||e.classList.contains("show"))return;t.style.display="block";const s=t.offsetHeight;t.style.height=0,t.style.overflow="hidden",t.style.transition=`height ${this._config.duration}ms ease`,t.classList.add("collapsing"),e.classList.add("slidedown"),t.offsetHeight,t.style.height=`${s}px`,window.setTimeout(()=>{t.classList.remove("collapsing"),e.classList.remove("slidedown"),t.classList.add("collapse"),e.classList.add("show"),t.style.display="",t.style.height="",t.style.transition="",t.style.overflow=""},this._config.duration)}hide(e){const t=e.querySelector("."+this._config.bodyClass);!t.classList.contains("collapsing")&&e.classList.contains("show")&&(t.style.height=`${t.offsetHeight}px`,t.offsetHeight,t.style.display="block",t.style.height=0,t.style.overflow="hidden",t.style.transition=`height ${this._config.duration}ms ease`,t.classList.remove("collapse"),e.classList.remove("show"),t.classList.add("collapsing"),window.setTimeout(()=>{t.classList.remove("collapsing"),t.classList.add("collapse"),t.style.display="",t.style.height="",t.style.transition="",t.style.overflow=""},this._config.duration))}toggle(e){e.classList.contains("show")?this.hide(e):this.show(e)}}class Modal{constructor(e){const t={backscroll:!0,linkAttrName:"data-modal",closeOnOverlay:!0,closeOnEsc:!0,closeBtnAttrName:"data-modal-close",catchFocus:!0,fixedSelectors:"*[data-fixed]",formData:{},beforeOpen:()=>{},afterClose:()=>{}};this.config=Object.assign(t,e),t.formData instanceof Object&&Object.keys(t.formData).length>0&&(this.config.formData=Object.assign({},e.formData)),this.config.linkAttrName&&this.init(),this._closeAfterTransition=this._closeAfterTransition.bind(this)}init(){this.isOpened=!1,this.openedWindow=!1,this.starter=!1,this._nextWindows=!1,this._scrollPosition=0,this._reopenTrigger=!1,this._overlayChecker=!1,this._isMoved=!1,this._form=null,this._focusElements=["a[href]","area[href]",'input:not([disabled]):not([type="hidden"]):not([aria-hidden])',"select:not([disabled]):not([aria-hidden])","textarea:not([disabled]):not([aria-hidden])","button:not([disabled]):not([aria-hidden])","iframe","object","embed","[contenteditable]",'[tabindex]:not([tabindex^="-"])'],this.eventsFeeler()}eventsFeeler(){document.addEventListener("click",e=>{const t=e.target.closest(`[${this.config.linkAttrName}]`);if(!this._isMoved&&t){e.preventDefault(),this.starter=t;const s=this.starter.getAttribute(this.config.linkAttrName);return this._nextWindows=document.querySelector("#"+s),void this.open()}e.target.closest(`[${this.config.closeBtnAttrName}]`)&&this.close()}),this.config.closeOnOverlay&&(document.addEventListener("mousedown",e=>{!this._isMoved&&e.target instanceof Element&&!e.target.classList.contains("modal__wrapper")||(this._overlayChecker=!0)}),document.addEventListener("mouseup",e=>{if(!this._isMoved&&e.target instanceof Element&&this._overlayChecker&&e.target.classList.contains("modal__wrapper"))return e.preventDefault(),this._overlayChecker=!this._overlayChecker,void this.close();this._overlayChecker=!1})),window.addEventListener("keydown",e=>{if(!this._isMoved&&this.config.closeOnEsc&&27===e.which&&this.isOpened)return e.preventDefault(),void this.close();!this._isMoved&&this.config.catchFocus&&9===e.which&&this.isOpened&&this.focusCatcher(e)})}open(e){if(e&&(this._nextWindows="string"==typeof e?document.querySelector(e):e),this._nextWindows){if(this.isOpened)return this._reopenTrigger=!0,void this.close();if(this.openedWindow=this._nextWindows,this._form=this.openedWindow.querySelector("form"),this.config.beforeOpen(this),this._bodyScrollControl(),this._form instanceof HTMLElement&&Object.keys(this.config.formData).length>0)for(const e in this.config.formData){let t=document.createElement("input");t.type="hidden",t.name=e,t.value=this.config.formData[e],t.setAttribute("data-form-data",!0),this._form.appendChild(t)}this.openedWindow.classList.add("modal--active"),this.openedWindow.setAttribute("aria-hidden","false"),this.config.catchFocus&&this.focusControl(),this.isOpened=!0}else console.log("Warning: Modal selector is not found")}close(){if(!this.isOpened)return;this._form.querySelectorAll("input[data-form-data]").forEach(e=>{this._form.removeChild(e)}),this.openedWindow.classList.add("modal--moved"),this._isMoved=!0,this.openedWindow.addEventListener("transitionend",this._closeAfterTransition),this.openedWindow.classList.remove("modal--active")}_closeAfterTransition(){this.openedWindow.classList.remove("modal--moved"),this.openedWindow.removeEventListener("transitionend",this._closeAfterTransition),this._isMoved=!1,this.openedWindow.setAttribute("aria-hidden","true"),this.config.catchFocus&&this.focusControl(),this._bodyScrollControl(),this.isOpened=!1,this.openedWindow.scrollTop=0,this.config.afterClose(this),this._reopenTrigger&&(this._reopenTrigger=!1,this.open())}focusControl(){const e=this.openedWindow.querySelectorAll(this._focusElements);this.isOpened&&this.starter?this.starter.focus():e.length&&e[0].focus()}focusCatcher(e){const t=this.openedWindow.querySelectorAll(this._focusElements),s=Array.prototype.slice.call(t);if(this.openedWindow.contains(document.activeElement)){const t=s.indexOf(document.activeElement);e.shiftKey&&0===t&&(s[s.length-1].focus(),e.preventDefault()),e.shiftKey||t!==s.length-1||(s[0].focus(),e.preventDefault())}else s[0].focus(),e.preventDefault()}_bodyScrollControl(){if(!this.config.backscroll)return;const e=document.querySelectorAll(this.config.fixedSelectors),t=Array.prototype.slice.call(e),s=document.documentElement;if(!0===this.isOpened)return s.classList.remove("modal-opened"),s.style.marginRight="",t.forEach(e=>{e.style.paddingRight=""}),window.scrollTo(0,this._scrollPosition),void(s.style.top="");this._scrollPosition=window.pageYOffset;const i=window.innerWidth-s.clientWidth;s.style.top=`${-this._scrollPosition}px`,i&&(s.style.marginRight=`${i}px`,t.forEach(e=>{e.style.paddingRight=`${parseInt(getComputedStyle(e).paddingRight,10)+i}px`})),s.classList.add("modal-opened")}}document.addEventListener("DOMContentLoaded",function(e){let t=function(e){window.requestAnimationFrame(function(){e()})},s=(new Modal,document.querySelectorAll("input[name=phone]")),i=document.querySelectorAll("input[name=name]");s.forEach(e=>{let t=new IMask(e,{mask:"+{7} (000) 000-00-00",lazy:!0,placeholderChar:"_"});e.addEventListener("focus",function(){t.updateOptions({lazy:!1})},!0),e.addEventListener("blur",function(){t.updateOptions({lazy:!0}),t.masked.rawInputValue||(t.value="")},!0)}),i.forEach(e=>{let t=new IMask(e,{mask:/^\W+$/,lazy:!0});e.addEventListener("focus",function(){t.updateOptions({lazy:!1})},!0),e.addEventListener("blur",function(){t.updateOptions({lazy:!0}),t.masked.rawInputValue||(t.value="")},!0)});let n=document.querySelector(".header"),o=document.querySelector(".header__top"),a=n.querySelector(".header__menu-open-btn"),l=!1;const r=document.documentElement;let d=0;a.addEventListener("click",function(e){if(l=!l,n.classList.toggle("header--active"),l){d=window.pageYOffset;const e=window.innerWidth-r.clientWidth;r.style.top=`${-d}px`,e&&(r.style.marginRight=`${e}px`,o.style.paddingRight=`${parseInt(getComputedStyle(el).paddingRight,10)+e}px`),r.classList.add("modal-opened")}else r.classList.remove("modal-opened"),r.style.marginRight="",o.style.paddingRight="",window.scrollTo(0,d),r.style.top=""}),document.querySelectorAll(".nav__inner-menu").forEach(e=>{let s=e.closest(".nav__item"),i=function(){e.style.opacity=0,e.addEventListener("transitionend",function(){e.classList.remove("nav__inner-menu--showed")},{once:!0})};s.addEventListener("click",function(n){e.classList.contains("nav__inner-menu--showed")&&!n.target.contains(e)?i():(e.classList.add("nav__inner-menu--showed"),t(()=>{e.style.opacity=1,document.addEventListener("click",e=>{if(window.innerWidth>992){let t=e.target;t==s||s.contains(t)||i()}},{once:!0})}))})});let c=document.querySelectorAll(".departure__districts-item input"),h=document.querySelectorAll(".departure__map svg path"),u=function(e){let t=document.querySelector(`.departure__map [data-id="${e.value}"]`);document.querySelector(".departure__map svg path.active").classList.remove("active"),t.classList.add("active"),new Modal({formData:{[e.name]:e.value}}).open("#modal-feedback")};h.forEach(e=>{let t=e.dataset.id;if(t&&""!==t){let s=document.querySelector('.departure__districts-item input[value="'+t+'"]');s&&""!==s&&(e.addEventListener("mouseenter",function(e){s.classList.add("hover")}),e.addEventListener("mouseleave",function(e){s.classList.remove("hover")}),e.addEventListener("click",function(e){s.checked=!0,u(s)}))}}),c.forEach(e=>{let t=e.value;if(t&&""!==t){let s=document.querySelector(`.departure__map [data-id="${t}"]`);s&&""!==s?(e.parentElement.addEventListener("mouseenter",function(e){s.classList.add("hover")}),e.parentElement.addEventListener("mouseleave",function(e){s.classList.remove("hover")}),e.addEventListener("click",function(t){u(e)})):e.addEventListener("click",function(t){new Modal({formData:{[e.name]:e.value}}).open("#modal-feedback")})}});let m=1,p=document.querySelector(".quiz__step-btn.arrow-btn--prev"),f=document.querySelector(".quiz__step-btn.arrow-btn--next"),_=document.querySelectorAll(".quiz__step"),v=document.querySelector(".quiz__steps-count b");f.addEventListener("click",function(e){m>=3||(++m>=3&&(f.classList.add("arrow-btn--disabled"),f.setAttribute("disabled",!0)),p.classList.remove("arrow-btn--disabled"),p.removeAttribute("disabled"),_.forEach(e=>{+e.dataset.quizId===m?(e.classList.add("active"),e.removeAttribute("inert")):(e.classList.remove("active"),e.setAttribute("inert",!0))}),v.textContent="шаг "+m)}),p.addEventListener("click",function(e){m<=1||(--m<=1&&(p.classList.add("arrow-btn--disabled"),p.setAttribute("disabled",!0)),f.classList.remove("arrow-btn--disabled"),f.removeAttribute("disabled"),_.forEach(e=>{e.classList.remove("active"),e.setAttribute("inert",!0),+e.dataset.quizId===m&&(e.classList.add("active"),e.removeAttribute("inert"))}),v.textContent="шаг "+m)}),new Accordion(".reasons__list",{alwaysOpen:!1,duration:350,itemClass:"reason",headerClass:"reason__head",bodyClass:"reason__body"});new Swiper(".masters__slider",{spaceBetween:30,wrapperClass:"masters__list",slideClass:"masters__item",loop:!0,slidesPerView:1,navigation:{nextEl:".masters__arrows .arrow-btn--next",prevEl:".masters__arrows .arrow-btn--prev",disabledClass:"arrow-btn--disabled"},pagination:{el:".masters__pagination",bulletClass:"pagination__bullet",bulletActiveClass:"pagination__bullet--active",clickable:!0},breakpoints:{768:{slidesPerView:2},1200:{spaceBetween:30,slidesPerView:4}}});let y=document.querySelectorAll(".form"),g=function(e){let s=new FormData(e),i=new XMLHttpRequest,n=e.querySelector('[type="submit"]');i.open("POST","form.php",!0),i.setRequestHeader("accept","application/json");let o=e.querySelector(".form__status");o||((o=document.createElement("div")).classList.add("form__status"),e.appendChild(o)),s.append("page",document.title),n.disabled=!0,i.send(s),i.onreadystatechange=function(){if(4===i.readyState)switch(i.status){case 200:!function(e){let s=document.createElement("div"),i=document.createElement("div"),n=document.createElement("div"),o=document.createElement("div");s.classList.add("thx"),i.classList.add("thx__icon"),n.classList.add("thx__title","title"),o.classList.add("thx__subtitle"),n.textContent="Спасибо",o.textContent="Lorem ipsum dolor sit amet, consectetur adipiscing elit. Ut blandit cursus nisi vel fermentum.",s.appendChild(i),s.appendChild(n),s.appendChild(o),e.style.opacity=0,e.addEventListener("transitionend",function(){this.style.display="none",s.style.opacity=0,this.parentElement.appendChild(s),t(()=>{s.style.opacity=1})})}(e);break;case 404:o.innerHTML="Сервер недоступен",n.disabled=!1,t(()=>{o.classList.add("form__status--showed")});break;default:o.innerHTML=i.responseText,n.disabled=!1,t(()=>{o.classList.add("form__status--showed")})}}};y.forEach(e=>{e.addEventListener("submit",function(e){e.preventDefault();let t=this.querySelectorAll("input"),s=!1;t.forEach(e=>{switch(e.getAttribute("name")){case"phone":e.value.length<18&&(s=!0,function(e,t){let s=document.createElement("div"),i=e.parentElement;e.classList.add("form__input--fault"),s.textContent=t,s.classList.add("form__message"),i.appendChild(s),s.style.opacity=1,setTimeout(()=>{e.classList.remove("form__input--fault"),s.style.opacity=null,s.addEventListener("transitionend",function(){i.removeChild(s)})},3e3)}(e,"Введите правильный номер телефона!"))}}),s||g(e.target)})})});