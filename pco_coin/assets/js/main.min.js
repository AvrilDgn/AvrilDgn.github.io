"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var Modal=function(){function e(t){_classCallCheck(this,e);this.config=Object.assign({backscroll:!0,linkAttrName:"data-modal",closeOnOverlay:!0,closeOnEsc:!0,closeBtnAttrName:"data-modal-close",catchFocus:!0,fixedSelectors:"*[data-fixed]",beforeOpen:function(){},afterClose:function(){}},t),this.config.linkAttrName&&this.init(),this._closeAfterTransition=this._closeAfterTransition.bind(this)}return _createClass(e,[{key:"init",value:function(){this.isOpened=!1,this.openedWindow=!1,this.starter=!1,this._nextWindows=!1,this._scrollPosition=0,this._reopenTrigger=!1,this._overlayChecker=!1,this._isMoved=!1,this._form=null,this._focusElements=["a[href]","area[href]",'input:not([disabled]):not([type="hidden"]):not([aria-hidden])',"select:not([disabled]):not([aria-hidden])","textarea:not([disabled]):not([aria-hidden])","button:not([disabled]):not([aria-hidden])","iframe","object","embed","[contenteditable]",'[tabindex]:not([tabindex^="-"])'],this.eventsFeeler()}},{key:"eventsFeeler",value:function(){var e=this;document.addEventListener("click",(function(t){var n=t.target.closest("[".concat(e.config.linkAttrName,"]"));if(!e._isMoved&&n){t.preventDefault(),e.starter=n;var o=e.starter.getAttribute(e.config.linkAttrName);return e._nextWindows=document.querySelector("#"+o),void e.open()}t.target.closest("[".concat(e.config.closeBtnAttrName,"]"))&&e.close()})),this.config.closeOnOverlay&&(document.addEventListener("mousedown",(function(t){!e._isMoved&&t.target instanceof Element&&!t.target.classList.contains("modal__wrapper")||(e._overlayChecker=!0)})),document.addEventListener("mouseup",(function(t){if(!e._isMoved&&t.target instanceof Element&&e._overlayChecker&&t.target.classList.contains("modal__wrapper"))return t.preventDefault(),e._overlayChecker=!e._overlayChecker,void e.close();e._overlayChecker=!1}))),window.addEventListener("keydown",(function(t){if(!e._isMoved&&e.config.closeOnEsc&&27===t.which&&e.isOpened)return t.preventDefault(),void e.close();!e._isMoved&&e.config.catchFocus&&9===t.which&&e.isOpened&&e.focusCatcher(t)}))}},{key:"open",value:function(e){if(e&&(this._nextWindows="string"==typeof e?document.querySelector(e):e),this._nextWindows){if(this.isOpened)return this._reopenTrigger=!0,void this.close();this.openedWindow=this._nextWindows,this._form=this.openedWindow.querySelector("form"),this.config.beforeOpen(this),this._bodyScrollControl(),this.openedWindow.classList.add("modal--active"),this.openedWindow.setAttribute("aria-hidden","false"),this.config.catchFocus&&this.focusControl(),this.isOpened=!0}else console.log("Warning: Modal selector is not found")}},{key:"close",value:function(){var e=this;if(this.isOpened){if(this._form)this._form.querySelectorAll("input[data-form-data]").forEach((function(t){e._form.removeChild(t)}));this.openedWindow.classList.add("modal--moved"),this._isMoved=!0,this.openedWindow.addEventListener("transitionend",this._closeAfterTransition),this.openedWindow.classList.remove("modal--active")}}},{key:"_closeAfterTransition",value:function(){this.openedWindow.classList.remove("modal--moved"),this.openedWindow.removeEventListener("transitionend",this._closeAfterTransition),this._isMoved=!1,this.openedWindow.setAttribute("aria-hidden","true"),this.config.catchFocus&&this.focusControl(),this._bodyScrollControl(),this.isOpened=!1,this.openedWindow.scrollTop=0,this.config.afterClose(this),this._reopenTrigger&&(this._reopenTrigger=!1,this.open())}},{key:"focusControl",value:function(){var e=this.openedWindow.querySelectorAll(this._focusElements);this.isOpened&&this.starter?this.starter.focus():e.length&&e[0].focus()}},{key:"focusCatcher",value:function(e){var t=this.openedWindow.querySelectorAll(this._focusElements),n=Array.prototype.slice.call(t);if(this.openedWindow.contains(document.activeElement)){var o=n.indexOf(document.activeElement);e.shiftKey&&0===o&&(n[n.length-1].focus(),e.preventDefault()),e.shiftKey||o!==n.length-1||(n[0].focus(),e.preventDefault())}else n[0].focus(),e.preventDefault()}},{key:"_bodyScrollControl",value:function(){if(this.config.backscroll){var e=document.querySelectorAll(this.config.fixedSelectors),t=Array.prototype.slice.call(e),n=document.querySelector(".main");if(!0===this.isOpened)return n.classList.remove("modal-opened"),n.style.paddingRight="",t.forEach((function(e){e.style.paddingRight=""})),window.scrollTo(0,this._scrollPosition),void(n.style.top="");this._scrollPosition=window.pageYOffset;var o=window.innerWidth-n.clientWidth;n.style.top="".concat(-this._scrollPosition,"px"),o&&(n.style.paddingRight="".concat(o,"px"),t.forEach((function(e){e.style.paddingRight="".concat(parseInt(getComputedStyle(e).paddingRight,10)+o,"px")}))),n.classList.add("modal-opened")}}}]),e}();document.addEventListener("DOMContentLoaded",(function(e){new Modal;document.querySelectorAll("input[type=tel]").forEach((function(e){var t=new IMask(e,{mask:"+{7} (000) 000-00-00",lazy:!0,placeholderChar:"_"});e.addEventListener("focus",(function(){t.updateOptions({lazy:!1})}),!0),e.addEventListener("blur",(function(){t.updateOptions({lazy:!0}),t.masked.rawInputValue||(t.value="")}),!0)}));var t=document.querySelector(".calc"),n=t.querySelectorAll('input[name="calc-day"]'),o=t.querySelector(".calc__percent-value"),i=document.querySelector('.calc__rate-value input[name="rate"]'),s=t.querySelector(".calc__result-value--coin"),r=t.querySelector(".calc__result-value--zloty"),a=0,l=0;function c(){a=this.dataset.percent,l=Math.floor(30/this.value)>1?1/Math.floor(30/this.value):this.value/30,o.textContent=a+"%",d()}function d(){var e=Math.floor(parseInt(i.value.replace(/\s+/g,""),10)/100*a*l);s.textContent=e,r.textContent=(20.81*e).toFixed(2),console.log(parseInt(i.value.replace(/\s+/g,""),10)+" "+a+" "+l)}n.forEach((function(e){e.checked&&c.call(e),e.addEventListener("change",c)}));var u=document.querySelector(".range-slider"),h=Number(u.dataset.min),f=Number(u.dataset.max),p=Number(u.dataset.startValue),v=document.querySelector("#"+u.dataset.input),m=u.querySelector(".range-slider__range"),_=u.querySelectorAll(".range-slider__change-btn");noUiSlider.create(m,{start:p,connect:"lower",step:1,range:{min:h,max:f},format:{from:function(e){return parseInt(e)},to:function(e){return parseInt(e)}}}),m.noUiSlider.on("update",(function(e,t){v.value=e[t].toString().replace(/\B(?=(\d{3})+(?!\d))/g," "),d()})),v.addEventListener("change",(function(){m.noUiSlider.set(this.value)})),_.forEach((function(e){var t=!1,n=!1;e.classList.contains("range-slider__change-btn--plus")&&(n=!0);for(var o=0,i=["mousedown","touchstart"];o<i.length;o++){var s=i[o];e.addEventListener(s,(function(){t=!0}))}for(var r=0,a=["mouseup","touchend"];r<a.length;r++){var l=a[r];e.addEventListener(l,(function(){t=!1}))}setInterval((function(){if(t){var e=m.noUiSlider.get();n?m.noUiSlider.set((++e).toString()):m.noUiSlider.set((--e).toString())}}),100)})),document.querySelectorAll(".slider--lg").forEach((function(e){var t=document.createElement("div");t.classList.add("slider__pagination"),e.appendChild(t),new Swiper(e,{freeMode:!0,slidesPerView:"auto",spaceBetween:30,wrapperClass:"slider__list",slideClass:"slider__slide",pagination:{el:t,bulletClass:"slider__bullet",bulletActiveClass:"active",clickable:!0}})}))}));